<?xml version="1.0"?>
<openerp>
	<data>

		<menuitem icon="terp-product" id="menu_main_fleets" name="Fleets" />
		<menuitem icon="terp-product" id="menu_fleet_maintenance" name="Fleet Maintenance Contracts" parent="fleet_maintenance.menu_main_fleets" />
		<menuitem icon="terp-product" id="menu_fleet" name="Fleets" parent="fleet_maintenance.menu_main_fleets" />
		<menuitem icon="terp-product" id="menu_fleet_extensions" name="Fleet Extensions" parent="fleet_maintenance.menu_main_fleets" />

		<menuitem action="stock.action_production_lot_form" id="menu_action_fleet_serial_tracking" parent="fleet_maintenance.menu_main_fleets" />




		<!-- Fleet -->

		<record model="ir.ui.view" id="stock.view_location_form">
			<field name="name">stock.location.fleet.form.fleet_maintenance</field>
			<field name="model">stock.location</field>
			<field name="type">form</field>
			<field name="arch" type="xml">

				<form string="Fleet">
						<!-- We have to factor those fields because else forms won't validate -->
						<field name="name" select="1" string="Name" />

		

					<!-- Original stock view -->
					<group col="6" colspan="4" attrs="{'invisible':[('fleet_type','!=','none')]}">
						<field name="active" select="2" />
						<field name="usage" select="1" />
						<field name="account_id" select="1" />
						<field name="location_id"/>

						<field context="{'context_display':'partner'}" name="address_id" />
						<field name="icon" />
						<newline />
						<group col="2" colspan="2">
							<separator colspan="2" string="Chained Locations" />
							<field name="chained_location_type" />
							<field name="chained_location_id" />
							<field name="chained_auto_packing" />
							<field name="chained_delay" />
						</group>
						<group col="2" colspan="2">
							<separator colspan="2" string="Localisation" />
							<field name="posx" />
							<field name="posy" />
							<field name="posz" />
						</group>
						<separator colspan="4" string="Additional Information" />
						<field colspan="4" name="comment" nolabel="1" />
					</group>


					<!-- Fleet Form View -->
					<group col="6" colspan="4" attrs="{'invisible':[('fleet_type','!=','fleet')]}">
						<field name="fleet_type" invisible="1" />
						<field name="partner_id" attrs="{'required':[('fleet_type','=','fleet')]}" domain="[('supplier','=', False)]" />
						<field context="{'context_display':'partner'}" name="address_id" />
						<field name="active" select="2" />
						<separator string="Maintenance Dates" colspan="4" />
						<group col="6" colspan="4">
							<field name="intrinsic_anniversary_time" string="Anniversary Time"
								on_change="intrinsic_anniversary_time_change(intrinsic_anniversary_time)" />
						</group>
						<separator string="Fleet Extensions" colspan="4" />
						<group col="6" colspan="4">
							<field name="child_ids" context="{'fleet_type':'sub_fleet'}" />
						</group>
					</group>


					<!-- Sub Fleets -->
					<group col="6" colspan="4" attrs="{'invisible':[('fleet_type','!=','sub_fleet')]}">
						<field name="fleet_type" invisible="1" />
						<field name="parent_fleet_id" on_change="onchange_parent_fleet_id(parent_fleet_id)" domain="[('fleet_type','=','fleet')]" attrs="{'required':[('fleet_type','=','sub_fleet')]}"/>
						<field name="address_id" context="{'context_display':'partner'}" />
						<field name="active" select="2" />
						<separator string="Maintenance Dates" colspan="4" />
						<group col="6" colspan="4">
							<field name="is_expired" />
							<field name="time_to_expire" />
							<field name="expire_time" />
							<newline />
							<field name="anniversary_time" />
						</group>

						<newline />


						<field colspan="4" nolabel="1" mode="tree,form,calendar" name="account_invoice_lines" />

						<field colspan="4" nolabel="1" name="sale_order_lines" />
						<field colspan="4" nolabel="1" name="crm_cases" />

						<field colspan="4" name="comment"/>

					</group>


				</form>
			</field>
		</record>


		<record id="stock.view_location_tree2" model="ir.ui.view">
			<field name="name">fleet_maintenance.tree</field>
			<field name="model">stock.location</field>
			<field name="type">tree</field>
			<field name="arch" type="xml">
				<tree string="Stock location" colors="red:is_expired==True;">
					<field name="complete_name" />
					<field name="partner_id" />
					<field name="stock_real" />
					<field name="stock_virtual" />
				</tree>
			</field>
		</record>



		<record id="fleet_normal_action" model="ir.actions.act_window">
			<field name="name">All Fleets</field>
			<field name="type">ir.actions.act_window</field>
			<field name="res_model">stock.location</field>
			<field name="view_type">form</field>
			<field name="domain">[('fleet_type','=','fleet')]</field>
			<field name="context">{'fleet_type':'fleet','location_id':8}</field>
		</record>
		<menuitem action="fleet_normal_action" id="all_fleets" parent="fleet_maintenance.menu_fleet" />

		<record id="ir_actions_act_window_view_0" model="ir.actions.act_window.view">
			<field name="act_window_id" ref="fleet_maintenance.fleet_normal_action" />
			<field eval="0" name="multi" />
			<field eval="&quot;&quot;&quot;tree&quot;&quot;&quot;" name="view_mode" />
			<field name="view_id" ref="fleet_maintenance.view_location_tree_fleet" />
			<field eval="0" name="sequence" />
		</record>
		<record id="ir_actions_act_window_view_1" model="ir.actions.act_window.view">
			<field name="act_window_id" ref="fleet_maintenance.fleet_normal_action" />
			<field eval="0" name="multi" />
			<field eval="&quot;&quot;&quot;form&quot;&quot;&quot;" name="view_mode" />
			<field name="view_id" ref="stock.view_location_form" />
			<field eval="1" name="sequence" />
		</record>


		<record id="action_fleet_new" model="ir.actions.act_window">
			<field name="name">New Fleet</field>
			<field name="type">ir.actions.act_window</field>
			<field name="res_model">stock.location</field>
			<field name="view_type">form</field>
			<!-- FIXME: location_id = 8 for customers is subject to changes according to your database data -->
			<field name="context">{'fleet_type':'fleet','location_id':8}</field>
			<field name="view_mode">form</field>
		</record>
		<menuitem action="action_fleet_new" id="menu_action_fleet_new" parent="fleet_maintenance.menu_fleet" />

		<record id="ir_actions_act_window_view_4" model="ir.actions.act_window.view">
			<field name="act_window_id" ref="fleet_maintenance.action_fleet_new" />
			<field eval="0" name="multi" />
			<field eval="&quot;&quot;&quot;form&quot;&quot;&quot;" name="view_mode" />
			<field name="view_id" ref="stock.view_location_form" />
		</record>







		<!-- Fleet extension -->

		<record id="view_location_tree_sub_fleet" model="ir.ui.view">
			<field name="name">sub_fleet.tree</field>
			<field name="model">stock.location</field>
			<field name="type">tree</field>
			<field name="arch" type="xml">
				<tree string="Stock location" colors="red:is_expired==True;">
					<field name="parent_partner_id" />
					<field name="complete_name" />
					<field name="is_expired" />
					<field name="time_to_expire" />
					<field name="stock_real" />
					<field name="stock_virtual" />
				</tree>
			</field>
		</record>
	
	
		<record id="sub_fleet_normal_action" model="ir.actions.act_window">
			<field name="name">All Sub Fleets</field>
			<field name="type">ir.actions.act_window</field>
			<field name="res_model">stock.location</field>
			<field name="view_type">form</field>
			<field name="domain">[('fleet_type','=','sub_fleet')]</field>
			<field name="context">{'fleet_type':'sub_fleet'}</field>
		</record>
		<menuitem action="sub_fleet_normal_action" id="all_s_b_fleets" parent="fleet_maintenance.menu_fleet_extensions" />

		<record id="ir_actions_act_window_view_6" model="ir.actions.act_window.view">
			<field name="act_window_id" ref="fleet_maintenance.sub_fleet_normal_action" />
			<field eval="0" name="multi" />
			<field eval="&quot;&quot;&quot;tree&quot;&quot;&quot;" name="view_mode" />
			<field name="view_id" ref="fleet_maintenance.view_location_tree_sub_fleet" />
			<field eval="0" name="sequence" />
		</record>
		<record id="ir_actions_act_window_view_7" model="ir.actions.act_window.view">
			<field name="act_window_id" ref="fleet_maintenance.sub_fleet_normal_action" />
			<field eval="0" name="multi" />
			<field eval="&quot;&quot;&quot;form&quot;&quot;&quot;" name="view_mode" />
			<field name="view_id" ref="stock.view_location_form" />
			<field eval="1" name="sequence" />
		</record>



		<record id="action_fleet_extension_new" model="ir.actions.act_window">
			<field name="name">New Fleet Extension</field>
			<field name="type">ir.actions.act_window</field>
			<field name="res_model">stock.location</field>
			<field name="view_type">form</field>
			<field name="view_mode">form</field>
			<field name="context">{'fleet_type':'sub_fleet','location_id':8}</field>
		</record>
		<menuitem action="action_fleet_extension_new" id="menu_action_fleet_extension_new" parent="menu_fleet_extensions" />


		<record id="ir_actions_act_window_view_fleet_new" model="ir.actions.act_window.view">
			<field name="act_window_id" ref="action_fleet_extension_new" />
			<field eval="1" name="multi" />
			<field name="view_id" ref="stock.view_location_form" />
			<field eval="&quot;&quot;&quot;form&quot;&quot;&quot;" name="view_mode" />
		</record>











		<!-- Fleet Maintenance orders -->


		<!--
			act_window id="act_stock_location_2_sale_order" name="Fleet Extensions Order" res_model="sale.order"
			src_model="stock.location" /> <record id="ir_actions_act_window_view_new_maintenance_form"
			model="ir.actions.act_window.view"> <field name="act_window_id" ref="act_stock_location_2_sale_order" /> <field
			eval="1" name="multi" /> <field name="view_id" ref="fleet_maintenance.view_location_form_fleet_maintenance" /> <field
			eval="&quot;&quot;&quot;form&quot;&quot;&quot;" name="view_mode" /> </record> <record
			id="ir_actions_act_window_view_new_maintenance_tree" model="ir.actions.act_window.view"> <field name="act_window_id"
			ref="act_stock_location_2_sale_order" /> <field eval="0" name="multi" /> <field
			eval="&quot;&quot;&quot;tree&quot;&quot;&quot;" name="view_mode" /> </record

	-->



		<record id="all_maintenances" model="ir.actions.act_window">
			<field name="name">All Maintenance Orders</field>
			<field name="type">ir.actions.act_window</field>
			<field name="res_model">sale.order</field>
			<field name="view_type">form</field>
			<field name="view_mode">tree,form,calendar,graph</field>
		</record>
		<menuitem action="all_maintenances" id="menu_action_all_maintenances" parent="menu_fleet_maintenance" />

		<record id="action_maintenance_new" model="ir.actions.act_window">
			<field name="name">New Maintenance quotation</field>
			<field name="type">ir.actions.act_window</field>
			<field name="res_model">sale.order</field>
			<field name="view_type">form</field>
			<field name="view_mode">form,tree,calendar,graph</field>
		</record>
		<menuitem action="action_maintenance_new" id="menu_action_maintenance_new" parent="menu_fleet_maintenance" />


		<record id="ir_actions_act_window_view_maintenance_new" model="ir.actions.act_window.view">
			<field name="act_window_id" ref="action_maintenance_new" />
			<field eval="0" name="multi" />
			<field name="view_id" ref="fleet_maintenance.sale_order_form_fleet_maintenance" />
			<field eval="&quot;&quot;&quot;form&quot;&quot;&quot;" name="view_mode" />
		</record>







	</data>
</openerp>