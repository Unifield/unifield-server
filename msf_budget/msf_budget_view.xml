<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

        <record model="ir.ui.view" id="msf_budget_view_tree">
            <field name="name">msf.budget.view.tree</field>
            <field name="model">msf.budget</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
               <tree colors="blue:state in ('draft');gray:state in ('done','cancel');black:state in ('confirm','validate')" string="Budget">
                    <field name="name" colspan="1"/>
                    <field name="code" colspan="1"/>
                    <field name="fiscalyear_id"/>
                    <field name="state"/>
                    <field name="decision_moment"/>
                    <field name="version"/>
                </tree>
            </field>
        </record>

        <record id="view_msf_budget_search" model="ir.ui.view">
           <field name="name">msf.budget.search</field>
           <field name="model">msf.budget</field>
           <field name="type">search</field>
           <field name="arch" type="xml">
               <search string="Budget">
                   <group col="20" colspan="4">
                       <filter string="Draft" icon="terp-document-new" domain="[('state','=','draft')]" help="Draft Budgets"/>
                       <filter name="validated" string="Validated" icon="terp-camera_test" domain="[('state','=','validate')]" help="Validated Budgets" />
                       <separator orientation="vertical"/>
                       <field name="name" select="1"/>
                       <field name="code" select="1" />
                       <field name="cost_center_id"/>
                       <field name="state"/>
                       <field name="fiscalyear_id"/>
                       <field name="currency_id"/>
                       <field name="decision_moment"/>
                       <field name="version"/>
                   </group>
               </search>
           </field>
        </record>

        <record model="ir.ui.view" id="msf_budget_view_form">
            <field name="name">msf.budget.view.form</field>
            <field name="model">msf.budget</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Budget">
                    <field name="name"/>
                    <field name="code"/>
                    <field name="fiscalyear_id"/>
                    <field name="cost_center_id"/>
                    <field name="decision_moment"/>
                    <field name="version"/>
                    <field name="currency_id"/>
                    <field name="currency_table_id"/>
                    <field name="budget_line_ids" colspan="4" nolabel="1">
                        <tree string="Budget Lines" editable="top" colors="black:line_type in ('normal');blue:line_type in ('view')">
                            <field name="account_id"/>
                            <field name="budget_amount" real_sum="Budget Amount"/>
                            <field name="actual_amount" real_sum="Actual Amount"/>
                            <field name="balance" real_sum="Balance"/>
                            <field name="percentage"/>
                            <field name="line_type"/>
                        </tree>
                    </field>
                    <field name="state" select="1"/>
                    <group col="4" colspan="2">
                        <button string="Approve" name="validate" states="draft" type="workflow" icon="gtk-ok"/>
                        <button string="Done" name="done" states="validate" type="workflow" icon="gtk-jump-to" />
                    </group>
                </form>
            </field>
        </record>

        <record model="ir.actions.act_window" id="act_crossovered_budget_view">
            <field name="name">Budgets</field>
            <field name="res_model">msf.budget</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="msf_budget_view_tree"/>
            <field name="search_view_id" ref="view_msf_budget_search"/>
            <field name="context">{'search_default_validated': 1}</field>
            <field name="help">A budget is a forecast of your company's income and expenses expected for a period in the future. With a budget, a company is able to carefully look at how much money they are taking in during a given period, and figure out the best way to divide it among various categories. By keeping track of where your money goes, you may be less likely to overspend, and more likely to meet your financial goals. Forecast a budget by detailing the expected revenue per analytic account and monitor its evolution based on the actuals realised during that period.</field>
        </record>
        
        <menuitem id="next_id_31" name="Budgets" parent="account.menu_finance" sequence="6"/>
        <menuitem parent="next_id_31"
            id="menu_act_crossovered_budget_view"
            action="act_crossovered_budget_view" sequence="1" />

    </data>
</openerp>
