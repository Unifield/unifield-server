<?xml version="1.0"?>
<?mso-application progid="Excel.Sheet"?>
<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
 xmlns:o="urn:schemas-microsoft-com:office:office"
 xmlns:x="urn:schemas-microsoft-com:office:excel"
 xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
 xmlns:html="http://www.w3.org/TR/REC-html40">
 <DocumentProperties xmlns="urn:schemas-microsoft-com:office:office">
  <Author>MSFUser</Author>
  <LastAuthor>MSFUser</LastAuthor>
  <Created>2012-06-18T15:46:09Z</Created>
  <Company>Medecins Sans Frontieres</Company>
  <Version>11.9999</Version>
 </DocumentProperties>
 <ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel">
  <WindowHeight>13170</WindowHeight>
  <WindowWidth>19020</WindowWidth>
  <WindowTopX>120</WindowTopX>
  <WindowTopY>60</WindowTopY>
  <ProtectStructure>False</ProtectStructure>
  <ProtectWindows>False</ProtectWindows>
 </ExcelWorkbook>


<Styles>

<Style ss:ID="Default" ss:Name="Normal">
<Alignment ss:Vertical="Bottom"/>
<Borders/>
<Font/>
<NumberFormat/>
<Protection/>
</Style>

<Style ss:ID="s16" ss:Name="Comma">
</Style>


<Style ss:ID="header">
<Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="1"/>
<Borders>
<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1" />
<Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1" />
<Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1" />
<Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1" />
</Borders>
</Style>

<Style ss:ID="line">
<Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="1"/>
<Borders>
<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1" />
<Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1" />
<Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1" />
<Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1" />
</Borders>
</Style>

<Style ss:ID="title">
<Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="1"/>
</Style>

<Style ss:ID="s22">
<Borders>
<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
</Borders>
</Style>
<Style ss:ID="s23">
<Borders>
<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
</Borders>
<NumberFormat ss:Format="Short Date"/>
</Style>
<Style ss:ID="s24">
<Borders>
<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
</Borders>
<NumberFormat ss:Format="mmm\-yy"/>
</Style>

<Style ss:ID="short_date">
<Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="1"/>
<Borders>
<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
</Borders>
<NumberFormat ss:Format="Short Date"/>
</Style>

<Style ss:ID="short_date2">
<Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="1"/>
<NumberFormat ss:Format="Short Date"/>
</Style>

<Style ss:ID="pop">
<Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="1"/>
</Style>

<Style ss:ID="s25">
<Borders>
<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
</Borders>
<Interior ss:Pattern="Solid"/>
</Style>


<Style ss:ID="s25c">
</Style>

<Style ss:ID="s25b">
<Font ss:Bold="1"/>
</Style>

<!-- <Style ss:ID="s25">
<Borders>
<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
</Borders>
</Style>

<Style ss:ID="s26" ss:Parent="s16">
<Borders>
<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
</Borders>
<NumberFormat />
<NumberFormat ss:Format="Fixed"/>
</Style> -->

<Style ss:ID="s26" >
<Borders>
<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
</Borders>
<NumberFormat ss:Format="Fixed"/>
</Style>



<Style ss:ID="s32">
<Alignment ss:Horizontal="Right" ss:Vertical="Bottom"/>
<Borders>
<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
</Borders>
<Font x:Family="Swiss" ss:Bold="1"/>
</Style>

<Style ss:ID="s34">
<Alignment ss:Vertical="Center" ss:WrapText="1"/>
<Borders>
<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
</Borders>
<Font ss:Bold="1"/>
</Style>


<Style ss:ID="s35">
<Alignment ss:Vertical="Center" ss:WrapText="1"/>
</Style>


<Style ss:ID="s38">
<Borders>
<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
</Borders>
</Style>


<Style ss:ID="s39" >
<Borders>
<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
</Borders>
</Style>

<Style ss:ID="s40">
<Borders>
<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
</Borders>
</Style>

<Style ss:ID="s41">
<Borders>
<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
</Borders>
<Font x:Family="Swiss" ss:Bold="1"/>
</Style>

<Style ss:ID="s42">
<Borders>
<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
</Borders>
</Style>

<Style ss:ID="s43" >
<Borders>
<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
</Borders>
</Style>

<Style ss:ID="s44" >
<Borders>
<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
</Borders>
<Font x:Family="Swiss" ss:Bold="1"/>
<NumberFormat ss:Format="Fixed"/>
</Style>


<Style ss:ID="s49">
<Alignment ss:Horizontal="Right" ss:Vertical="Bottom"/>
<Borders>
<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="2"/>
<Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="2"/>
<Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="2"/>
</Borders>
<Font x:Family="Swiss" ss:Bold="1"/>
</Style>

<Style ss:ID="s50" >
<Borders>
<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="2"/>
<Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="2"/>
</Borders>
<Font x:Family="Swiss" ss:Bold="1"/>
<NumberFormat ss:Format="Fixed"/>
</Style>

<Style ss:ID="s51">
<Borders>
<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="2"/>
<Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
<Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="2"/>
<Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="2"/>
</Borders>
<Font x:Family="Swiss" ss:Bold="1"/>
</Style>
</Styles>


<Worksheet ss:Name="Liquidity position">
<Table >
<Column ss:AutoFitWidth="0" ss:Width="110.5"/>
<Column ss:AutoFitWidth="0" ss:Width="102.75" ss:Span="1"/>
<Column  ss:AutoFitWidth="0" ss:Width="103.5" ss:Span="1"/>
<Column  ss:AutoFitWidth="0" ss:Width="75.75"/>
<Column ss:AutoFitWidth="0" ss:Width="103.5" ss:Span="1"/>
<Column  ss:AutoFitWidth="0" ss:Width="70.75"/>

<Row>
<Cell ss:StyleID="s25b" >
<Data ss:Type="String">${_('LIQUIDITY POSITION')}</Data>
</Cell>
</Row>
<Row ss:Height="13.5"/>
<Row >
<Cell>
<Data ss:Type="String">${_('Report Date:')}</Data>
</Cell>
<Cell ss:StyleID="short_date2" >
<Data ss:Type="DateTime">${time.strftime('%Y-%m-%d')|n}T00:00:00.000</Data>
</Cell>
</Row>
<Row>
<Cell>
<Data ss:Type="String">${_('Prop Instance: ')}</Data>
</Cell>
<Cell ss:StyleID="pop">
<Data ss:Type="String">${( company.instance_id and company.instance_id.code or '')|x}</Data>
</Cell>
</Row>
<Row ss:Height="13.5"/>

<Row  ss:AutoFitHeight="0" ss:Height="25.5" ss:StyleID="s35">
		<Cell ss:StyleID="s34" >
<Data ss:Type="String">${_('Proprietary instance')}</Data>
</Cell>
		<Cell ss:StyleID="s34" >
<Data ss:Type="String">${_('Journal Code')}</Data>
</Cell>
		<Cell ss:StyleID="s34" >
<Data ss:Type="String">${_('Journal Name')}</Data>
</Cell>
		<Cell ss:StyleID="s34" >
<Data ss:Type="String">${_('Calculated Balance in register currency')}</Data>
</Cell>
		<Cell ss:StyleID="s34" >
<Data ss:Type="String">${_('Register Balance in register currency')}</Data>
</Cell>
		<Cell ss:StyleID="s34" >
<Data ss:Type="String">${_('Register Currency')}</Data>
</Cell>
		<Cell ss:StyleID="s34" >
<Data ss:Type="String">${_('Calculated Balance in functional currency')}</Data>
</Cell>
		<Cell ss:StyleID="s34" >
<Data ss:Type="String">${_('Register Balance in functional currency')}</Data>
</Cell>
		<Cell ss:StyleID="s34" >
<Data ss:Type="String">${_('Functional Currency')}</Data>
</Cell>
</Row>

% for reg in getRegister():
	% for o in getRegister2()[reg]:
	<Row>
        <Cell ss:StyleID="s25" >
<Data ss:Type="String">${(o.instance_id and o.instance_id.code or '')|x}</Data>
</Cell>
        <Cell ss:StyleID="s25" >
<Data ss:Type="String">${(o.journal_id and o.journal_id.code or '')|x}</Data>
</Cell>
        <Cell ss:StyleID="s25" >
<Data ss:Type="String">${(o.journal_id and o.journal_id.name or '')|x}</Data>
</Cell>
        <Cell ss:StyleID="s26" >
<Data ss:Type="Number">${(o.msf_calculated_balance or 0.0)|x}</Data>
</Cell>
        % if o.journal_id.type == 'cash' :
        	<Cell ss:StyleID="s26" >
<Data ss:Type="Number">${(o.balance_end_cash or 0.0)|x}</Data>
</Cell>
	% endif
        % if o.journal_id.type == 'bank' :
        	<Cell ss:StyleID="s26" >
<Data ss:Type="Number">${(o.balance_end_real or 0.0)|x}</Data>
</Cell>
	% endif
        <Cell ss:StyleID="s25" >
<Data ss:Type="String">${( o.journal_id and o.journal_id.currency and o.journal_id.currency.name or '')|x}</Data>
</Cell>
        <Cell ss:StyleID="s26" >
<Data ss:Type="Number">${( getConvert(o.journal_id.currency,o.journal_id.company_id.currency_id,o.msf_calculated_balance, 'cal') or 0.0 )|x}</Data>
</Cell>

        % if o.journal_id.type == 'cash' :
        	<Cell ss:StyleID="s26" >
<Data ss:Type="Number">${( getConvert(o.journal_id.currency,o.journal_id.company_id.currency_id,o.balance_end_cash,'reg') or 0.0 )|x}</Data>
</Cell>
	% endif
        % if o.journal_id.type == 'bank' :
        	<Cell ss:StyleID="s26" >
<Data ss:Type="Number">${( getConvert(o.journal_id.currency,o.journal_id.company_id.currency_id,o.balance_end_real,'reg') or 0.0 )|x}</Data>
</Cell>
	% endif
        <Cell ss:StyleID="s25" >
<Data ss:Type="String">${( getFuncCur(o) or '')|x}</Data>
</Cell>
	</Row>

% endfor

<Row>
	<Cell ss:StyleID="s42"/>
	<Cell ss:StyleID="s38">
	<NamedCell ss:Name="Print_Area"/>
	</Cell>
	<Cell ss:StyleID="s38">
	<NamedCell ss:Name="Print_Area"/>
	</Cell>
	<Cell ss:StyleID="s39">
	<NamedCell ss:Name="Print_Area"/>
	</Cell>
	<Cell ss:StyleID="s43">
	<NamedCell ss:Name="Print_Area"/>
	</Cell>
	<Cell ss:StyleID="s32">
	<Data ss:Type="String">${_('Sub-Total =')}</Data>
	<NamedCell ss:Name="Print_Area"/>
	</Cell>
	<Cell ss:StyleID="s44" ss:Formula="=SUM(R[-${getCal()}]C:R[-1]C)" >
	<Data ss:Type="Number"></Data>
	<NamedCell ss:Name="Print_Area"/>
	</Cell>
	<Cell ss:StyleID="s44" ss:Formula="=SUM(R[-${getRes()}]C:R[-1]C)" >
	<Data ss:Type="Number"></Data>
	<NamedCell ss:Name="Print_Area"/>
	</Cell>
	<Cell ss:StyleID="s41">
	<Data ss:Type="String">${( getCurTot() or '')|x}</Data>
	<NamedCell ss:Name="Print_Area"/>
	</Cell>
</Row>
<Row ss:Height="13.5"/>
% endfor


<Row ss:Height="13.5">
	<Cell ss:StyleID="s25c"/>
	<Cell ss:StyleID="s25c"/>
	<Cell ss:StyleID="s25c"/>
	<Cell ss:StyleID="s25c"/>
	<Cell ss:StyleID="s25c"/>

	<Cell  ss:StyleID="s49">
	<Data ss:Type="String">${_('Grand Total =')}</Data>
	<NamedCell ss:Name="Print_Area"/>
	</Cell>
	<Cell ss:StyleID="s50" ss:Formula="=${getFormula()}+R[-2]C">
	<Data ss:Type="Number"></Data>
	<NamedCell ss:Name="Print_Area"/>
	</Cell>
	<Cell ss:StyleID="s50" ss:Formula="=${getFormula()}+R[-2]C">
	<Data ss:Type="Number"></Data>
	<NamedCell ss:Name="Print_Area"/>
	</Cell>
	<Cell ss:StyleID="s51">
	<Data ss:Type="String">${( getCurTot() or '')|x}</Data>
	<NamedCell ss:Name="Print_Area"/>
	</Cell>
</Row>


</Table>


<WorksheetOptions>
<FitToPage/>
<Print>
<ValidPrinterInfo/>
<PaperSizeIndex>9</PaperSizeIndex>
<Scale>63</Scale>
<HorizontalResolution>600</HorizontalResolution>
<VerticalResolution>0</VerticalResolution>
</Print>
<PageBreakZoom>60</PageBreakZoom>
<Selected/>
<DoNotDisplayGridlines/>
<Panes>
<Pane>
<Number>3</Number>
<ActiveRow>24</ActiveRow>
<ActiveCol>3</ActiveCol>
</Pane>
</Panes>
<ProtectObjects>False</ProtectObjects>
<ProtectScenarios>False</ProtectScenarios>
</WorksheetOptions>

</Worksheet>



</Workbook>
