<?xml version="1.0"?>
<openerp>
      <data>
            <!-- CASH REQUEST - FORM VIEW -->
            <record id="view_cash_request_form" model="ir.ui.view">
                <field name="name">cash.request.form</field>
                <field name="model">cash.request</field>
                <field name="type">form</field>
                <field name="arch" type="xml">
                    <form string="Cash Request">
                        <notebook colspan="4">
                            <page string="Main Tab">
                                <button name="generate_cash_request" type="object" string="Generate" icon="gtk-execute"/>
                                <separator colspan="4" string="Settings"/>
                                <group colspan="4" col="4">
                                    <field name="id" invisible="1"/>
                                    <field name="name"/>
                                    <field name="state"/>
                                    <field name="request_date"/>
                                    <field name="month_period_id"/>
                                    <field name="mission"/>
                                    <field name="prop_instance_id"/>
                                    <field name="transfer_account_id"/>
                                    <field name="bank_journal_id"/>
                                    <field name="transfer_currency_ids">
                                        <tree string="Currencies">
                                            <field name="currency_id"/>
                                            <field name="percentage"/>
                                        </tree>
                                    </field>
                                    <field name="consolidation_currency_id"/>
                                </group>
                                <group colspan="3" col="2">
                                    <field name="instance_ids">
                                        <tree string="Instances">
                                            <field name="code"/>
                                            <field name="name"/>
                                            <field name="level"/>
                                        </tree>
                                    </field>
                                </group>
                                <group colspan="4" col="6">
                                    <field name="transfer_to_come"/>
                                    <field name="security_envelope"/>
                                    <field name="buffer"/>
                                </group>
                                <button name="compute_total_to_transfer" type="object"
                                        string="Compute total to transfer" icon="gtk-refresh"/>
                                <field name="total_to_transfer"/>
                                <field name="consolidation_currency_name" nolabel="1"/>
                                <group colspan="4" col="2">
                                    <field name="total_to_transfer_line_ids" nolabel="1">
                                        <tree string="Split per currencies">
                                            <field name="currency_id"/>
                                            <field name="amount"/>
                                        </tree>
                                    </field>
                                </group>
                            </page>
                            <page string="Banking">
                                <separator colspan="4" string="Banking references"/>
                                <field name="journal_name"/>
                                <field name="journal_code"/>
                                <field name="account_name"/>
                                <field name="account_number"/>
                                <field name="swift_code"/>
                                <field name="bank_address"/>
                            </page>
                            <page string="Commitment">
                                <separator colspan="4" string="Commitment"/>
                                <field name="commitment_ids" nolabel="1">
                                    <tree string="Engagement entries">
                                        <field name="instance_code"/>
                                        <field name="total_commitment"
                                               string="Total Engagement in Func. currency for the month to come"/>
                                    </tree>
                                </field>
                            </page>
                        </notebook>
                    </form>
                </field>
            </record>

            <!-- CASH REQUEST - TREE VIEW -->
            <record id="view_cash_request_tree" model="ir.ui.view">
                <field name="name">cash.request.tree</field>
                <field name="model">cash.request</field>
                <field name="type">tree</field>
                <field name="arch" type="xml">
                    <tree>
                        <field name="name"/>
                        <field name="request_date"/>
                        <field name="month_period_id"/>
                    </tree>
                </field>
            </record>

            <!-- CASH REQUEST - SEARCH VIEW -->
            <record id="view_cash_request_search" model="ir.ui.view">
                <field name="name">cash.request.search</field>
                <field name="model">cash.request</field>
                <field name="type">search</field>
                <field name="arch" type="xml">
                    <search>
                        <group col="6" colspan="4">
                            <field name="prop_instance_id" string="Top Proprietary Instance"/>
                            <field name="month_period_id" domain="[('special', '=', False)]"/> <!-- allow selecting any month -->
                            <field name="fiscalyear_id"/>
                        </group>
                    </search>
                </field>
            </record>

            <!-- CASH REQUEST - ENTRY IN MENU -->
            <record id="action_cash_request_tree" model="ir.actions.act_window">
                <field name="name">Cash Request</field>
                <field name="res_model">cash.request</field>
                <field name="view_type">form</field>
                <field name="view_mode">tree,form</field>
                <field name="context">{}</field>
                <field name="search_view_id" ref="view_cash_request_search"/>
            </record>
            <menuitem action="action_cash_request_tree" id="menu_action_cash_request_tree"
                      parent="account.menu_finance_periodical_processing"
                      sequence="12"/>
       </data>
</openerp>
