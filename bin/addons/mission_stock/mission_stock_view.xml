<?xml version="1.0" encoding="utf-8" ?>
<openerp>
<data>

    <record id="mission_stock_wizard_view" model="ir.ui.view">
        <field name="name">mission.stock.wizard.view</field>
        <field name="model">mission.stock.wizard</field>
        <field name="type">form</field>
        <field name="priority">1</field>
        <field name="arch" type="xml">
            <form string="Mission stock report">
                <field name="export_ok" invisible="1" />
                <field name="local_report" invisible="1" />
                <field name="full_view" invisible="1" />
                <separator colspan="4" string="Mission stock" />
                <field name="report_id" widget="selection" on_change="report_change(report_id)" />
                <field name="last_update" />
                <label colspan="4" />
                <field name="processed_state" string="Updating..." attrs="{'invisible': [('local_report', '!=', True)]}"/>
                <field name="processed_start_date" attrs="{'invisible': [('processed_state', '!=', 'in_progress')]}"/>
                <separator colspan="4" string="Stock valuation" />
                <field name="with_valuation" />
                <separator colspan="4" string="Product in stock" />
                <field name="display_only_in_stock" />
                <group colspan="4" attrs="{'invisible': [('export_error_msg', '=', False)]}">
                    <separator colspan="4" string="Errors"/>
                    <field name="export_error_msg" colspan="4" />
                </group>
                <separator colspan="4" string="Actions" />
                <button name="update" string="Update (in background)" type="object" colspan="4" icon="gtk-remove" attrs="{'invisible': ['|', ('local_report', '!=', True), ('full_view', '=', True)]}"/>
                <button special="cancel" string="Close window" icon="gtk-cancel" colspan="2" />
                <button name="open_products_view" string="Open report" type="object" icon="gtk-go-forward" colspan="2" attrs="{'readonly': [('processed_state', 'not in', ('done', 'draft'))]}" />
                <button name="open_xls_file" string="Open XLS file" type="object" icon="gtk-print" colspan="2" attrs="{'readonly': [('processed_state', 'not in', ('done', 'draft'))]}" />
                <button name="open_csv_file" string="Open CSV file" type="object" icon="gtk-print" colspan="2" attrs="{'readonly': [('processed_state', 'not in', ('done', 'draft'))]}" />
            </form>
        </field>
    </record>

    <record id="mission_stock_wizard_open_file_view" model="ir.ui.view">
        <field name="name">mission.stock.wizard.open.file.view</field>
        <field name="model">mission.stock.wizard</field>
        <field name="type">form</field>
        <field name="priority" eval="99" />
        <field name="arch" type="xml">
            <form string="Mission stock report CSV file">
                <separator colspan="4" string="File" />
                <field name="export_file" filename="fname" />
                <field name="fname" invisible="1"/>
                <separator colspan="4" string="Actions" />
                <label colspan="2"> </label>
                <button name="go_previous" icon="terp-gtk-go-back-ltr" string="Previous" type="object" colspan="1" />
                <button special="cancel" icon="gtk-cancel" string="Close window" colspan="1" />
            </form>
        </field>
    </record>

    <record id="mission_stock_wizard_action" model="ir.actions.act_window">
        <field name="name">Mission stock report</field>
        <field name="res_model">mission.stock.wizard</field>
        <field name="view_type">form</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
    </record>

    <menuitem id="mission_stock_wizard_menu"
              parent="stock.next_id_61"
              sequence="5"
              action="mission_stock_wizard_action" />

    <record id="mission_stock_line_search_view" model="ir.ui.view">
        <field name="name">mission.stock.line.search.view</field>
        <field name="model">stock.mission.report.line</field>
        <field name="type">search</field>
        <field name="arch" type="xml">
            <search string="Mission stock lines">
               <filter string="Stockable" icon="terp-accessories-archiver" domain="[('type','=','product')]"/>
               <filter string="Non-Stockable" icon="terp-accessories-archiver" domain="[('type','=','consu')]"/>
               <filter string="Service with Reception" icon="terp-accessories-archiver" domain="[('type','=','service_recep')]" />
               <separator orientation="vertical"/>
               <field name="default_code"/>
               <field name="name"/>
               <field name="categ_id" widget="selection" operator="child_of"/>
               <field name="used_in_transaction" />
               <newline/>
               <filter string="Single Item" icon="terp-accessories-archiver" domain="[('subtype','=','single')]"/>
               <filter string="Kit/Module" icon="terp-accessories-archiver" domain="[('subtype','=','kit')]"/>
               <filter string="Asset" icon="terp-accessories-archiver" domain="[('subtype','=','asset')]"/>
               <newline />
                <group expand="1" string="Nomenclature Filters...">
                    <field name="nomen_manda_0_s"
                        domain="[('parent_id', '=', -1)]"
                         widget="selection"
                        on_change="onChangeSearchNomenclature(0, 'mandatory', nomen_manda_0_s, nomen_manda_1_s, nomen_manda_2_s, nomen_manda_3_s, True, context)" />
                    <field name="nomen_manda_1_s"
                        domain="[('parent_id', '=', -1)]"
                         widget="selection"
                        on_change="onChangeSearchNomenclature(1, 'mandatory', nomen_manda_0_s, nomen_manda_1_s, nomen_manda_2_s, nomen_manda_3_s, True, context)" />
                    <field name="nomen_manda_2_s"
                        domain="[('parent_id', '=', -1)]"
                         widget="selection"
                        on_change="onChangeSearchNomenclature(2, 'mandatory', nomen_manda_0_s, nomen_manda_1_s, nomen_manda_2_s, nomen_manda_3_s, True, context)" />
                    <field name="nomen_manda_3_s"
                        domain="[('parent_id', '=', -1)]"
                         widget="selection"
                        on_change="onChangeSearchNomenclature(3, 'mandatory', nomen_manda_0_s, nomen_manda_1_s, nomen_manda_2_s, nomen_manda_3_s, True, context)" />
                </group>
                <newline />
                <group expand="0" string="Optional Nomenclature Filters...">
                    <field name="nomen_sub_0_s" domain="[('parent_id', '=', -1)]" widget="selection" />
                    <field name="nomen_sub_1_s" domain="[('parent_id', '=', -1)]" widget="selection" />
                    <field name="nomen_sub_2_s" domain="[('parent_id', '=', -1)]" widget="selection" />
                    <field name="nomen_sub_3_s" domain="[('parent_id', '=', -1)]" widget="selection" />
                    <field name="nomen_sub_4_s" domain="[('parent_id', '=', -1)]" widget="selection" />
                    <field name="nomen_sub_5_s" domain="[('parent_id', '=', -1)]" widget="selection" />
                </group>
                <newline />
                <group expand="0" string="Group by...">
                    <filter string='Category' icon="terp-stock_symbol-selection" domain="[]" context="{'group_by' : 'categ_id'}" />
                    <separator orientation="vertical"/>
                    <filter string='Default UOM' icon="terp-mrp" domain="[]" context="{'group_by' : 'uom_id'}" />
                    <separator orientation="vertical"/>
                    <filter string='Type' icon="terp-stock_symbol-selection" domain="[]" context="{'group_by' : 'type'}" />
                </group>
            </search>
        </field>
    </record>

    <record id="mission_stock_line_list_view" model="ir.ui.view">
        <field name="name">mission.stock.product.list.view</field>
        <field name="model">stock.mission.report.line</field>
        <field name="type">tree</field>
        <field name="arch" type="xml">
            <tree string="Mission Stock Report" hide_new_button="1" hide_delete_button="1" editable="top" noteditable="1" colors="red:mml_status=='F' or msl_status=='F'">
                <field name="default_code" />
                <field name="name" />
                <field name="product_active" />
                <field name="mml_status" invisible="not context.get('show_mml')"/>
                <field name="msl_status" invisible="not context.get('show_mml')"/>
                <field name="uom_id" />
                <field name="cost_price" invisible="not context.get('with_valuation')" />
                <field name="currency_id" invisible="not context.get('with_valuation')" />
                <field name="internal_qty" />
                <field name="internal_val" invisible="not context.get('with_valuation')" />
                <!-- field name="in_pipe_coor_qty" />
                <field name="in_pipe_coor_val" invisible="not context.get('with_valuation')" / -->
                <field name="stock_qty" />
                <field name="cross_qty" />
                <!-- <field name="cross_val" invisible="not context.get('with_valuation')" /> -->
                <field name="secondary_qty" />
                <!-- <field name="secondary_val" invisible="not context.get('with_valuation')" /> -->
                <field name="cu_qty" />
                <field name="eprep_qty" />
                <field name="quarantine_qty" />
                <field name="input_qty" />
                <field name="opdd_qty" />
                <!-- <field name="cu_val" invisible="not context.get('with_valuation')" /> -->
                <field name="product_amc" invisible="context.get('hide_amc_fmc')"/>
                <field name="product_consumption" invisible="context.get('hide_amc_fmc')" />
                <field name="used_in_transaction" />
                <field name="in_pipe_qty" />
                <field name="categ_id" invisible="1" />
                <field name="type" invisible="1" />
            </tree>
        </field>
    </record>
    
    <record id="mission_stock_line_form_view" model="ir.ui.view">
        <field name="name">mission.stock.product.form.view</field>
        <field name="model">stock.mission.report.line</field>
        <field name="type">form</field>
        <field name="arch" type="xml">
            <form string="Mission Stock Report" noteditable="1" hide_new_button="1" hide_save_button="1" hide_duplicate_button="1" hide_delete_button="1">
                <field name="product_id" />
                <field name="default_code" />
                <field name="name" />
                <field name="product_active" />
                <field name="uom_id" />
                <field name="cost_price" invisible="not context.get('with_valuation')" />
                <field name="currency_id" invisible="not context.get('with_valuation')" />
                <field name="internal_qty" />
                <field name="internal_val" invisible="not context.get('with_valuation')" />
                <!-- field name="in_pipe_coor_qty" />
                <field name="in_pipe_coor_val" invisible="not context.get('with_valuation')" / -->
                <field name="stock_qty" />
                <field name="cross_qty" />
                <!-- <field name="cross_val" invisible="not context.get('with_valuation')" /> -->
                <field name="secondary_qty" />
                <!-- <field name="secondary_val" invisible="not context.get('with_valuation')" /> -->
                <field name="cu_qty" />
                <field name="eprep_qty" />
                <field name="quarantine_qty" />
                <field name="input_qty" />
                <field name="opdd_qty" />
                <!-- <field name="cu_val" invisible="not context.get('with_valuation')" /> -->
                <field name="product_amc" invisible="context.get('hide_amc_fmc')"/>
                <field name="product_consumption" invisible="context.get('hide_amc_fmc')" />
                <field name="used_in_transaction" />
                <field name="in_pipe_qty" />
                <field name="categ_id" invisible="1" />
                <field name="type" invisible="1" />
            </form>
        </field>
    </record>


    <record id="consolidated_mission_stock_wizard_view" model="ir.ui.view">
        <field name="name">consolidated.mission.stock.wizard.view</field>
        <field name="model">mission.stock.wizard</field>
        <field name="type">form</field>
        <field name="priority">3</field>
        <field name="arch" type="xml">
            <form string="Consolidated Mission Stock Report">
                <field name="export_ok" invisible="1" />
                <field name="local_report" invisible="1" />
                <field name="full_view" invisible="1" />
                <separator colspan="4" string="Mission stock" />
                <field name="last_update" />
                <label colspan="4" />
                <field name="processed_state" string="Updating..." attrs="{'invisible': [('local_report', '!=', True)]}"/>
                <field name="processed_start_date" attrs="{'invisible': [('processed_state', '!=', 'in_progress')]}"/>
                <group colspan="4" attrs="{'invisible': [('export_error_msg', '=', False)]}">
                    <separator colspan="4" string="Errors"/>
                    <field name="export_error_msg" colspan="4" />
                </group>
                <separator colspan="4" string="Actions" />
                <button name="update" string="Update (in background)" type="object" colspan="2" icon="gtk-remove" attrs="{'invisible': ['|', ('local_report', '!=', True), ('full_view', '=', True)]}"/>
                <button special="cancel" string="Close window" icon="gtk-cancel" colspan="2" />
                <button name="open_consolidated_xls" string="Open Consolidated XLS file" type="object" icon="gtk-print" colspan="4" attrs="{'readonly': ['|', ('processed_state', '!=', 'done'), ('export_ok', '=', False)]}" />
            </form>
        </field>
    </record>

    <record id="consolidated_mission_stock_wizard_action" model="ir.actions.act_window">
        <field name="name">Consolidated Mission Stock Report</field>
        <field name="res_model">mission.stock.wizard</field>
        <field name="view_type">form</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="view_id" ref="consolidated_mission_stock_wizard_view" />
    </record>

</data>
</openerp>
