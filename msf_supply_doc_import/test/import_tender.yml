-
  Create Tender (T1)
- 
  !record {model: tender, id: t1}:
    name: My Tender test
    creator: base.user_root
    requested_date: !eval time.strftime('%Y-%m-%d')
    location_id: stock.stock_location_stock
    categ: medical
    warehouse_id: stock.stock_warehouse_shop0
-
  Open the wizard
-
  !python {model: tender}: |
    import addons, base64
    wizard_values = self.wizard_import_tender_line(cr, uid, ref("t1"), context)
    assert wizard_values.get('res_model', False) == 'wizard.import.tender.line', "Wizard should be wizard.import.tender.line"
    wiz_context = wizard_values.get('context')
    file_path = addons.get_module_resource('msf_supply_doc_import','test','import_files_for_testing', 'tender.xml')
    file = open(file_path, 'r')
    file64 = base64.b64encode(file.read())
    self.pool.get(wizard_values['res_model']).write(cr, uid, [wizard_values['res_id']],
                                            {'file': file64}, context=wiz_context)
-
  Import tender lines
-
  !python {model: wizard.import.tender.line}: |
    import logging
    tender_id = self.pool.get('tender').search(cr, uid, [('name', '=', 'My Tender test')])
    if tender_id:
        wiz_id = self.search(cr, uid, [('tender_id', '=', tender_id[0])])
        logging.getLogger('tests').log(logging.TEST, 'We import tender.xml.')
        # not working below: to be reviewed
        # self._import(cr, uid, wiz_id, context)
